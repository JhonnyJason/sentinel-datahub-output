/*! For license information please see service.js.LICENSE.txt */
(()=>{"use strict";var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{hasAccess:()=>A,initialize:()=>b,setAccess:()=>S,unsetAccess:()=>O});var n={};t.r(n),t.d(n,{blockIp:()=>ce,initialize:()=>fe,isBlocked:()=>le});var r={};t.r(r),t.d(r,{initialize:()=>de,signatureAuth:()=>he});var i={};t.r(i),t.d(i,{accessManagerId:()=>Me,checkAccessMS:()=>Re,checkSymbolsMS:()=>Be,fallbackAuthCode:()=>Ue,legalOrigins:()=>Le,mrktStackSecret:()=>De,name:()=>Pe,persistentStateOptions:()=>Fe,snitchSocket:()=>He,trdvtCid:()=>je,trdvtPassword:()=>Ie,trdvtSecret:()=>Te,trdvtUsername:()=>ze,urlMrktStack:()=>_e,urlTrdvt:()=>Je,version:()=>qe});var o={};t.r(o),t.d(o,{daysBetween:()=>an,generateDateRange:()=>sn,nextDay:()=>rn,prevDay:()=>on});var a={};t.r(a),t.d(a,{executeSpecialMission:()=>hn,getStockAllHistory:()=>ln,getStockNewerHistory:()=>dn,getStockOlderHistory:()=>cn,initialize:()=>fn});var s={};t.r(s),t.d(s,{initialize:()=>Gn,load:()=>Ln,remove:()=>Un,save:()=>Hn});var u={};t.r(u),t.d(u,{initialize:()=>ur});var f={};t.r(f),t.d(f,{executeSpecialMission:()=>lr,getData:()=>cr,initialize:()=>fr});var l={};t.r(l);var c={};t.r(c),t.d(c,{prepareAndExpose:()=>ti});var d={};t.r(d),t.d(d,{serviceStartup:()=>di});var h,g,y={};t.r(y),t.d(y,{initialize:()=>hi,startSession:()=>gi}),g=function(t){return JSON.stringify(t,null,4)},h={};var p,v,m,w=function(t){var e,n;return n=function(t){return e("\n"+g(t))},{log:e=function(e){h[t]&&console.log("["+t+"]: "+e)},olog:n}};({log:v,olog:m}=w("accessmodule")),p=Object.create(null);var b=function(t){v("initialize"),t.fallbackAuthCode&&(p[t.fallbackAuthCode]={})},S=function({authCode:t,ttlMS:e}){var n,r;v("setAccess"),v(t),v(e),n=function(){return O(t)},null!=(r=p[t])?clearTimeout(r.deathTimerId):r={},r.deathTimerId=setTimeout(n,e),p[t]=r},O=function(t){var e;v("unsetAccess"),null!=(e=p[t])&&(clearTimeout(e.deathTimerId),delete p[t])},A=function(t){return null!=p[t]};const{p:E,n:$,Gx:x,Gy:N,a:C,d:k}={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},T=(t="")=>{throw new Error(t)},j=t=>"string"==typeof t,z=(t,e)=>!(t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name)(t)||"number"==typeof e&&e>0&&t.length!==e?T("Uint8Array expected"):t,I=t=>new Uint8Array(t),D=t=>Uint8Array.from(t),J=(t,e)=>t.toString(16).padStart(e,"0"),_=t=>Array.from(z(t)).map(t=>J(t,2)).join(""),R=t=>t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:void 0,B=t=>{const e="hex invalid";if(!j(t))return T(e);const n=t.length,r=n/2;if(n%2)return T(e);const i=I(r);for(let n=0,o=0;n<r;n++,o+=2){const r=R(t.charCodeAt(o)),a=R(t.charCodeAt(o+1));if(void 0===r||void 0===a)return T(e);i[n]=16*r+a}return i},P=(t,e)=>z(j(t)?B(t):D(z(t)),e),q=()=>globalThis?.crypto,M=(...t)=>{const e=I(t.reduce((t,e)=>t+z(e).length,0));let n=0;return t.forEach(t=>{e.set(t,n),n+=t.length}),e},H=BigInt,L=(t,e,n,r="bad number: out of range")=>(t=>"bigint"==typeof t)(t)&&e<=t&&t<n?t:T(r),U=(t,e=E)=>{const n=t%e;return n>=0n?n:e+n},F=(t,e)=>{(0n===t||e<=0n)&&T("no inverse n="+t+" mod="+e);let n=U(t,e),r=e,i=0n,o=1n,a=1n,s=0n;for(;0n!==n;){const t=r/n,e=r%n,u=i-a*t,f=o-s*t;r=n,n=e,i=a,o=s,a=u,s=f}return 1n===r?U(i,e):T("no inverse")},V=t=>t instanceof Z?t:T("Point expected"),G=2n**256n;class Z{static BASE;static ZERO;ex;ey;ez;et;constructor(t,e,n,r){const i=G;this.ex=L(t,0n,i),this.ey=L(e,0n,i),this.ez=L(n,1n,i),this.et=L(r,0n,i),Object.freeze(this)}static fromAffine(t){return new Z(t.x,t.y,1n,U(t.x*t.y))}static fromBytes(t,e=!1){const n=k,r=D(z(t,32)),i=t[31];r[31]=-129&i;const o=Q(r);L(o,0n,e?G:E);const a=U(o*o),s=U(a-1n),u=U(n*a+1n);let{isValid:f,value:l}=et(s,u);f||T("bad point: y not sqrt");const c=1n==(1n&l),d=!!(128&i);return!e&&0n===l&&d&&T("bad point: x==0, isLastByteOdd"),d!==c&&(l=U(-l)),new Z(l,o,1n,U(l*o))}assertValidity(){const t=C,e=k;if(this.is0())throw new Error("bad point: ZERO");const{ex:n,ey:r,ez:i,et:o}=this,a=U(n*n),s=U(r*r),u=U(i*i),f=U(u*u),l=U(a*t);if(U(u*U(l+s))!==U(f+U(e*U(a*s))))throw new Error("bad point: equation left != right (1)");if(U(n*r)!==U(i*o))throw new Error("bad point: equation left != right (2)");return this}equals(t){const{ex:e,ey:n,ez:r}=this,{ex:i,ey:o,ez:a}=V(t),s=U(e*a),u=U(i*r),f=U(n*a),l=U(o*r);return s===u&&f===l}is0(){return this.equals(K)}negate(){return new Z(U(-this.ex),this.ey,this.ez,U(-this.et))}double(){const{ex:t,ey:e,ez:n}=this,r=C,i=U(t*t),o=U(e*e),a=U(2n*U(n*n)),s=U(r*i),u=t+e,f=U(U(u*u)-i-o),l=s+o,c=l-a,d=s-o,h=U(f*c),g=U(l*d),y=U(f*d),p=U(c*l);return new Z(h,g,p,y)}add(t){const{ex:e,ey:n,ez:r,et:i}=this,{ex:o,ey:a,ez:s,et:u}=V(t),f=C,l=k,c=U(e*o),d=U(n*a),h=U(i*l*u),g=U(r*s),y=U((e+n)*(o+a)-c-d),p=U(g-h),v=U(g+h),m=U(d-f*c),w=U(y*p),b=U(v*m),S=U(y*m),O=U(p*v);return new Z(w,b,O,S)}multiply(t,e=!0){if(!e&&(0n===t||this.is0()))return K;if(L(t,1n,$),1n===t)return this;if(this.equals(W))return ft(t).p;let n=K,r=W;for(let i=this;t>0n;i=i.double(),t>>=1n)1n&t?n=n.add(i):e&&(r=r.add(i));return n}toAffine(){const{ex:t,ey:e,ez:n}=this;if(this.equals(K))return{x:0n,y:1n};const r=F(n,E);return 1n!==U(n*r)&&T("invalid inverse"),{x:U(t*r),y:U(e*r)}}toBytes(){const{x:t,y:e}=this.assertValidity().toAffine(),n=Y(e);return n[31]|=1n&t?128:0,n}toHex(){return _(this.toBytes())}clearCofactor(){return this.multiply(H(8n),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.multiply($/2n,!1).double();return $%2n&&(t=t.add(this)),t.is0()}static fromHex(t,e){return Z.fromBytes(P(t),e)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}}const W=new Z(x,N,1n,U(x*N)),K=new Z(0n,1n,1n,0n);Z.BASE=W,Z.ZERO=K;const Y=t=>B(J(L(t,0n,G),64)).reverse(),Q=t=>H("0x"+_(D(z(t)).reverse())),X=(t,e)=>{let n=t;for(;e-- >0n;)n*=n,n%=E;return n},tt=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,et=(t,e)=>{const n=U(e*e*e),r=(t=>{const e=t*t%E*t%E,n=X(e,2n)*e%E,r=X(n,1n)*t%E,i=X(r,5n)*r%E,o=X(i,10n)*i%E,a=X(o,20n)*o%E,s=X(a,40n)*a%E,u=X(s,80n)*s%E,f=X(u,80n)*s%E,l=X(f,10n)*i%E;return{pow_p_5_8:X(l,2n)*t%E,b2:e}})(t*U(n*n*e)).pow_p_5_8;let i=U(t*n*r);const o=U(e*i*i),a=i,s=U(i*tt),u=o===t,f=o===U(-t),l=o===U(-t*tt);return u&&(i=a),(f||l)&&(i=s),1n==(1n&U(i))&&(i=U(-i)),{isValid:u||f,value:i}},nt=t=>{return e=Q(t),U(e,$);var e},rt=t=>((...t)=>ot.sha512Async(...t))(t.hashable).then(t.finish),it={zip215:!0},ot={sha512Async:async(...t)=>{const e=q()?.subtle??T("crypto.subtle must be defined"),n=M(...t);return I(await e.digest("SHA-512",n.buffer))},sha512Sync:void 0,bytesToHex:_,hexToBytes:B,concatBytes:M,mod:U,invert:F,randomBytes:(t=32)=>q().getRandomValues(I(t))},at=Math.ceil(32)+1;let st;const ut=(t,e)=>{const n=e.negate();return t?n:e},ft=t=>{const e=st||(st=(()=>{const t=[];let e=W,n=e;for(let r=0;r<at;r++){n=e,t.push(n);for(let r=1;r<128;r++)n=n.add(e),t.push(n);e=n.double()}return t})());let n=K,r=W;const i=H(255),o=H(8);for(let a=0;a<at;a++){let s=Number(t&i);t>>=o,s>128&&(s-=256,t+=1n);const u=128*a,f=u,l=u+Math.abs(s)-1,c=a%2!=0,d=s<0;0===s?r=r.add(ut(c,e[f])):n=n.add(ut(d,e[l]))}return{p:n,f:r}};var lt,ct,dt;new(require("string_decoder").StringDecoder)("utf-8"),new Array(256).fill(0).map(function(t,e){return BigInt(e)}),dt=Array.from("0123456789abcdef"),ct=new Array(256),dt.forEach(function(t){return ct[t]=16*parseInt(t,16)}),lt=new Array(256),dt.forEach(function(t){return lt[t]=parseInt(t,16)});var ht,gt=function(t){var e,n,r,i;for(i=new Uint8Array(t.length/2),e=n=0,r=t.length;n<r;e=n+=2)i[e/2]=ct[t[e]]+lt[t[e+1]];return i};require("crypto"),ht=BigInt(2)**BigInt(252)+BigInt("27742317777372353535851937790883648493");var yt,pt=async function(t,e,n){var r,i,o,a;return o=gt(t),i=gt(e),a=n,r=new Uint8Array(Buffer.from(a,"utf8")),await(async(t,e,n,r=it)=>rt(((t,e,n,r=it)=>{t=P(t,64),e=P(e),n=P(n,32);const{zip215:i}=r;let o,a,s,u,f=Uint8Array.of();try{o=Z.fromHex(n,i),a=Z.fromHex(t.slice(0,32),i),s=Q(t.slice(32,64)),u=W.multiply(s,!1),f=M(a.toBytes(),o.toBytes(),e)}catch(t){}return{hashable:f,finish:t=>{if(null==u)return!1;if(!i&&o.isSmallOrder())return!1;const e=nt(t);return a.add(o.multiply(e,!1)).add(u.negate()).clearCofactor().is0()}}})(t,e,n,r)))(o,r,i)};yt=18e4;var vt,mt,wt,bt,St,Ot,At,Et,$t,xt,Nt,Ct,kt,Tt,jt,zt,It,Dt;for(It=null,zt=/^\d+$/,Tt=/(\.\.|--|-\.)|\.-/,Ct=new Array(103),kt=0;kt<22;)Ct["0123456789abcdefABCDEF".charCodeAt(kt)]=!0,kt++;for(Et=new Array(123),kt=0;kt<64;)Et["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-.".charCodeAt(kt)]=!0,kt++;for(At="\0\b\v\f\rÂÂ‚ÂƒÂ„Â†Â‡ÂˆÂ‰ÂŠÂ‹ÂŒÂÂŽÂÂÂ‘Â’Â“Â”Â•Â–Â—Â˜Â™ÂšÂ›ÂœÂÂžÂŸ",Ot=new Array(160),kt=0;kt<61;)Ot[At.charCodeAt(kt)]=!0,kt++;jt=function(t){var e,n,r,i;if(null!==t){for(e=0,i=(r=Object.keys(t)).length;e<i;e++){if("__proto__"===(n=r[e])||"constructor"===n||"prototype"===n)return!0;if("object"==typeof t[n]&&jt(t[n]))return!0}return!1}},bt=function(t){return function(e){if(e!==t)return Kt}},St=function(t){return function(){throw new Error(t)}},$t=function(t){var e;if(null==(e=Dt[t]))throw new Error(`Unrecognized Schematype! (${t})`);return e},xt=function(t){var e,n,r,i;for(n=new Array(t.length),kt=r=0,i=t.length;r<i;kt=++r)switch(e=t[kt],!1){case"number"!=typeof e:n[kt]=$t(e);break;case"string"!=typeof e:n[kt]=It(e);break;case"object"==typeof e:throw new Error(`Illegal ${typeof e}!`);case!Array.isArray(e):n[kt]=mt(e);break;default:n[kt]=wt(e)}return n},Nt=function(t){var e,n,r,i,o,a;for(i=Object.keys(t),e=[],kt=n=0,o=i.length;n<o;kt=++n)if("number"!=typeof(a=t[r=i[kt]]))if("string"!=typeof a){if("object"!=typeof a)throw new Error(`Illegal ${typeof a}!`);Array.isArray(a)?e.push([r,mt(a)]):e.push([r,wt(a)])}else e.push([r,It(a)]);else e.push([r,$t(a)]);return e},mt=function(t){var e,n;if(0===t.length)throw new Error("[] is illegal!");return n=xt(t),e=function(t){var e,r,i,o,a,s;if(!Array.isArray(t))return Kt;for(o=0,kt=a=0,s=n.length;a<s;kt=++a)if(i=n[kt],void 0!==(e=t[kt])&&o++,r=i(e))return r;return t.length>o?Kt:void 0},e},wt=function(t){var e,n;if(null===t)throw new Error("null is illegal!");if(0===(n=Nt(t)).length)throw new Error("{} is illegal!");return e=function(t){var e,r,i,o,a,s;if("object"!=typeof t)return Kt;if(null===t)return Kt;for(i=0,o=0,a=n.length;o<a;o++)if(void 0!==(s=t[(e=n[o])[0]])&&i++,r=e[1](s))return r;return Object.keys(t).length>i?Kt:void 0},e},(Dt=new Array(47))[5]=function(t){if("string"!=typeof t)return Jt},Dt[6]=function(t){var e,n,r,i,o,a,s;if("string"!=typeof t)return Jt;if(t.length>320||t.length<5)return Ht;if(Tt.test(t))return Mt;if((e=t.indexOf("@"))<=0||e>64||t.length-e<4||"."===t[0]||"."===t[e-1]||"-"===t[0]||"-"===t[e-1]||"."===t[e+1]||"-"===t[e+1])return Mt;for(kt=i=0,a=t.length;i<a;kt=++i)if(n=t[kt],!(Et[t.charCodeAt(kt)]||kt===e||kt<e&&("+"===n||"_"===n)))return Mt;if("."===t[t.length-1]||"-"===t[t.length-1])return Mt;if(o=e,(r=t.indexOf(".",e+1))<0)return Mt;for(;r>0;){if(r-o>63)return Mt;o=r,r=t.indexOf(".",o+1)}return s=t.slice(o+1),zt.test(s)?Mt:void 0},Dt[7]=function(t){if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[8]=function(t){if("string"!=typeof t)return Jt;if(32!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[9]=function(t){if("string"!=typeof t)return Jt;if(64!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[10]=function(t){if("string"!=typeof t)return Jt;if(128!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[11]=function(t){if("string"!=typeof t)return Jt;if(256!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[12]=function(t){if("string"!=typeof t)return Jt;if(512!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[2]=function(t){return"number"!=typeof t?_t:isNaN(t)?Lt:Infinity===t||-Infinity===t?Wt:void 0},Dt[1]=function(t){if("boolean"!=typeof t)return Rt},Dt[3]=function(t){if(!Array.isArray(t))return Bt},Dt[4]=function(t){if("object"!=typeof t)return Pt},Dt[21]=function(t){if(void 0!==t)return"string"!=typeof t?Jt:void 0},Dt[22]=function(t){var e,n,r,i,o,a,s;if(void 0!==t){if("string"!=typeof t)return Jt;if(t.length>320||t.length<5)return Ht;if(Tt.test(t))return Mt;if((e=t.indexOf("@"))<=0||e>64||t.length-e<4||"."===t[0]||"."===t[e-1]||"-"===t[0]||"-"===t[e-1]||"."===t[e+1]||"-"===t[e+1])return Mt;for(kt=i=0,a=t.length;i<a;kt=++i)if(n=t[kt],!(Et[t.charCodeAt(kt)]||kt===e||kt<e&&("+"===n||"_"===n)))return Mt;if("."===t[t.length-1]||"-"===t[t.length-1])return Mt;if(o=e,(r=t.indexOf(".",e+1))<0)return Mt;for(;r>0;){if(r-o>63)return Mt;o=r,r=t.indexOf(".",o+1)}return s=t.slice(o+1),zt.test(s)?Mt:void 0}},Dt[23]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[24]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;if(32!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[25]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;if(64!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[26]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;if(128!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[27]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;if(256!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[28]=function(t){if(void 0!==t){if("string"!=typeof t)return Jt;if(512!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[30]=function(t){if(void 0!==t)return"number"!=typeof t?_t:isNaN(t)?Lt:Infinity===t||-Infinity===t?Wt:void 0},Dt[31]=function(t){if(void 0!==t)return"boolean"!=typeof t?Rt:void 0},Dt[32]=function(t){if(void 0!==t)return Array.isArray(t)?void 0:Bt},Dt[33]=function(t){if(void 0!==t)return"object"!=typeof t?Pt:void 0},Dt[35]=function(t){if(null!==t)return"string"!=typeof t?Jt:void 0},Dt[36]=function(t){var e,n,r,i,o,a,s;if(null!==t){if("string"!=typeof t)return Jt;if(t.length>320||t.length<5)return Ht;if(Tt.test(t))return Mt;if((e=t.indexOf("@"))<=0||e>64||t.length-e<4||"."===t[0]||"."===t[e-1]||"-"===t[0]||"-"===t[e-1]||"."===t[e+1]||"-"===t[e+1])return Mt;for(kt=i=0,a=t.length;i<a;kt=++i)if(n=t[kt],!(Et[t.charCodeAt(kt)]||kt===e||kt<e&&("+"===n||"_"===n)))return Mt;if("."===t[t.length-1]||"-"===t[t.length-1])return Mt;if(o=e,(r=t.indexOf(".",e+1))<0)return Mt;for(;r>0;){if(r-o>63)return Mt;o=r,r=t.indexOf(".",o+1)}return s=t.slice(o+1),zt.test(s)?Mt:void 0}},Dt[37]=function(t){if(null!==t){if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[38]=function(t){if(null!==t){if("string"!=typeof t)return Jt;if(32!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[39]=function(t){if(null!==t){if("string"!=typeof t)return Jt;if(64!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[40]=function(t){if(null!==t){if("string"!=typeof t)return Jt;if(128!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[41]=function(t){if(null!==t){if("string"!=typeof t)return Jt;if(256!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[42]=function(t){if(null!==t){if("string"!=typeof t)return Jt;if(512!==t.length)return Ht;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}}},Dt[44]=function(t){if(null!==t)return"number"!=typeof t?_t:isNaN(t)?Lt:Infinity===t||-Infinity===t?Wt:void 0},Dt[45]=function(t){if(null!==t)return"boolean"!=typeof t?Rt:void 0},Dt[46]=function(t){if(null!==t)return Array.isArray(t)?void 0:Bt},Dt[19]=function(t){return"object"!=typeof t?Pt:null===t?Ut:void 0},Dt[14]=function(t){return"string"!=typeof t?Jt:0===t.length?Ft:void 0},Dt[17]=function(t){return Array.isArray(t)?0===t.length?Vt:void 0:Bt},Dt[15]=function(t){if("string"!=typeof t)return Jt;if(0===t.length)return Ft;for(kt=0;kt<t.length;){if(void 0===Ct[t.charCodeAt(kt)])return qt;kt++}},Dt[16]=function(t){var e;if("string"!=typeof t)return Jt;if(0===t.length)return Ft;for(kt=0;kt<t.length;){if((e=t.charCodeAt(kt))>767||Ot[e])return Gt;kt++}},Dt[13]=function(t){var e;if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if((e=t.charCodeAt(kt))>767||Ot[e])return Gt;kt++}},Dt[43]=function(t){var e;if(null!==t){if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if((e=t.charCodeAt(kt))>767||Ot[e])return Gt;kt++}}},Dt[29]=function(t){var e;if(void 0!==t){if("string"!=typeof t)return Jt;for(kt=0;kt<t.length;){if((e=t.charCodeAt(kt))>767||Ot[e])return Gt;kt++}}},Dt[18]=function(t){return"object"!=typeof t?Pt:jt(t)?Zt:void 0},Dt[20]=function(t){return"object"!=typeof t?Pt:null===t?Ut:jt(t)?Zt:void 0},Dt[34]=function(t){if(void 0!==t)return"object"!=typeof t?Pt:jt(t)?Zt:void 0};var Jt=1e3,_t=1001,Rt=1002,Bt=1003,Pt=1004,qt=1005,Mt=1006,Ht=1007,Lt=1008,Ut=1009,Ft=1010,Vt=1011,Gt=1012,Zt=1013,Wt=1014,Kt=2222;(vt=Object.create(null))[Jt]="Not a String!",vt[_t]="Not a Number!",vt[Rt]="Not a Boolean!",vt[Bt]="Not an Array!",vt[Pt]="Not an Object!",vt[qt]="String is not valid hex!",vt[Mt]="String is not a valid email!",vt[Ht]="String size mismatch!",vt[Lt]="Number is NaN!",vt[Ut]="Object is null!",vt[Ft]="String is empty!",vt[Vt]="Array is empty!",vt[Gt]="String is dirty!",vt[Zt]="Object is dirty!",vt[Wt]="Number is not finite!",vt[Kt]="Is invalid!";var Yt,Qt,Xt,te,ee=function(t,e){var n;if(It=!0===e?bt:St("Static string!"),"number"==(n=typeof t))return $t(t);if("string"===n)return It(t);if("object"!==n)throw new Error(`Illegal ${typeof t}!`);return Array.isArray(t)?mt(t):wt(t)};({log:Xt,olog:te}=w("earlyblockermodule")),Qt=new Set,Yt=new Set;var ne,re,ie,oe,ae,se,ue,fe=function(t){var e,n,r,i,o;for(Xt("initialize"),n=0,r=(o=t.legalOrigins).length;n<r;n++)i=o[n],Qt.add(i);e=new Array(...Qt),Xt(`legalOrigins: ${e}`)},le=function(t,e){return Xt("isBlocked"),Yt.has(t)?(Xt(`blocked request with IP: ${t}`),"IP blocked!"):Qt.has(e)?void Xt("passed!"):(Xt(`blocked request with origin: ${e}`),Yt.add(t),"Illegal Origin!")},ce=function(t){return Yt.add(t)};({log:re,olog:oe}=w("authmodule")),ne=null,se=6e5,ue=ee({senderId:9,timestamp:2,nonce:2,signature:10}),ie=Object.create(null);var de=function(t){re("initialize"),ne=t.accessManagerId,setInterval(ae,se)};ae=function(){var t,e;for(t in e=Date.now(),ie)ie[t]<e&&delete ie[t]};var he=async function(t,e){var n,r,i,o,a;return re("signatureAuth"),oe(e),r=e.meta.ip,n=e.meta.host,le(r,n)?"Client Blocked!":ue(e.auth)?"Invalid Auth Object!":e.auth.senderId!==ne?"Unauthorized Sender!":function(t){var e,n;if(t!==(n=(e=Date.now())-e%yt)&&t!==(n-=yt))return t!==(n+=36e4)?"invalid":void 0}(e.auth.timestamp)?"Invalid Timestamp!":(i=e.auth.nonce,null!=ie[i]?"Nonce used already!":(ie[i]=Date.now()+se,o=e.auth.signature,a=e.bodyString.replace(o,"\"'\\"),await pt(o,ne,a)?void re("We have a fully authorized Request!"):"Invalid Signature!"))};const ge=require("node:path");var ye=t.n(ge);const pe=require("node:fs");var ve=t.n(pe);const me=require("node:net");var we,be,Se,Oe,Ae,Ee=t.n(me);({log:we,olog:be}=w("bugsnitch")),Se=new Promise(function(t){return t}),Ae="unnamed",Oe=async function(t){var e;we("sendToBugsnitch"),await Se,(e=Ee().createConnection("/run/bugsnitch.sk")).on("connect",function(){return e.end(t)}),e.on("error",function(t){return console.error(t)}),e.on("close",function(){return we("Connection closed!")})};var $e,xe,Ne,Ce,ke=function(t){var e,n;if(we("report"),console.error(t),"string"!=typeof t)try{return n=`[${Ae}] Error: `+t.message,t.cause&&(n+="\n Cause: "+t.cause),t.stack&&(n+="\n Stack: "+t.stack),void Oe(n)}catch(t){e=t,console.error("bugsnitch.report: unexpected errorObject!\n "+e.message)}else Oe(n=`[${Ae}]: ${t}`)};xe=Object.create(null);try{$e=ye().resolve(process.cwd(),"./.config.json"),Ne=ve().readFileSync($e,"utf8"),xe=JSON.parse(Ne)}catch(t){Ce="@configmodule - config parsing:\n",Ce+=" Local Config File could not be read or parsed!\n ",Ce+=t.message,ke(Ce)}var Te=xe.secret||"none",je=xe.cid||"none",ze=xe.name||"none",Ie=xe.password||"none",De=xe.mrktStackSecret||"none",Je="https://live.tradovateapi.com/v1",_e="https://api.marketstack.com/v2",Re=6e5,Be=36e5,Pe="Sentinel Datahub",qe="v0.0.1",Me=xe.accessManagerId||"",He=xe.snitchSocket||"/run/bugsnitch.sk",Le=["localhost","localhost:3333","sentinel-datahub-dev.dotv.ee","sentinel-datahub.dotv.ee"],Ue="aaaaaaaabbbbbbbbccccccccdddddddd",Fe={basePath:"../state",maxCacheSize:128};xe=null;var Ve,Ge,Ze,We,Ke,Ye,Qe,Xe,tn,en,nn,rn=function(t){var e;return(e=new Date(t+"T00:00:00Z")).setUTCDate(e.getUTCDate()+1),e.toISOString().substring(0,10)},on=function(t){var e;return(e=new Date(t+"T00:00:00Z")).setUTCDate(e.getUTCDate()-1),e.toISOString().substring(0,10)},an=function(t,e){var n,r;return r=new Date(t+"T00:00:00Z"),n=new Date(e+"T00:00:00Z"),Math.floor((n-r)/864e5)},sn=function(t,e){var n,r,i;for(r=[],n=new Date(t+"T00:00:00Z"),i=new Date(e+"T00:00:00Z");n<=i;)r.push(n.toISOString().substring(0,10)),n.setUTCDate(n.getUTCDate()+1);return r},un=[].indexOf;({log:Xe,olog:en}=w("marketstackmodule")),Ve=null,Ze=null,ye().resolve(".","symbols.json"),ye().resolve(".","currencies.json"),Ge=!1;var fn=function(t){Xe("initialize"),null!=t.mrktStackSecret&&(Ve=t.mrktStackSecret),null!=t.urlMrktStack&&(Ze=t.urlMrktStack)},ln=async function(t){var e,n,r;return Xe(`getStockAllHistory: ${t}`),null==(r=await We(t))?null:(null!=r.error&&(n=r.error,Qe(n)?Xe(`Plan limit reached: ${n.code}`):Xe(`API error: ${n.code}: ${n.message}`)),0===r.data.length?(Xe("No data received"),null):(e=tn(r.data,t),(e=Ye(e)).meta.historyComplete=null==r.error,Xe(`Returning ${e.data.length} data points, historyComplete: ${e.meta.historyComplete}`),e))},cn=async function(t,e){var n,r,i,o;return Xe(`getStockOlderHistory: ${t} olderThan=${e}`),r=on(e),null==(o=await We(t,{date_to:r}))?null:(null!=o.error&&(i=o.error,Qe(i)?Xe(`Plan limit reached: ${i.code}`):Xe(`API error: ${i.code}: ${i.message}`)),0===o.data.length?(Xe("No older data available"),null):(n=tn(o.data,t),(n=Ye(n)).meta.historyComplete=null==o.error,Xe(`Returning ${n.data.length} older data points`),n))},dn=async function(t,e){var n,r,i,o;return Xe(`getStockNewerHistory: ${t} newerThan=${e}`),r=rn(e),null==(o=await We(t,{date_from:r}))?null:(null!=o.error&&(i=o.error,Qe(i)?Xe(`Plan limit reached: ${i.code}`):Xe(`API error: ${i.code}: ${i.message}`)),0===o.data.length?(Xe("No newer data available"),null):(n=tn(o.data,t),n=Ye(n),Xe(`Returning ${n.data.length} newer data points`),n))};We=async function(t,e={}){var n,r,i,o,a,s,u,f;if(Xe(`fetchAllEodPages: ${t}`),Ge)return null;try{for(Ge=!0,n=[],a=0,f=performance.now(),r=0;;){if(s=await Ke(t,{offset:a,limit:1e3,...e}),r++,null!=(i=s.error))return{error:i,data:n};if(n.push(...s.data),u=s.pagination,n.length>=u.total)return{data:n};a+=1e3,r%5==0&&((o=1001-(performance.now()-f))>0&&await nn(o),Xe(`counter: ${r} => missingPerdiodMS: ${o}`),f=performance.now())}}catch(t){return Xe(i=t)}finally{Ge=!1}},Ke=async function(t,{offset:e,limit:n,date_from:r,date_to:i}){var o,a,s,u,f,l;Xe(`fetchEodPage: ${t} offset=${e}`),o=t.replace(/\./g,"-"),u=new URLSearchParams({access_key:Ve,symbols:o,sort:"ASC",limit:n.toString(),offset:e.toString()}),null!=r&&u.set("date_from",r),null!=i&&u.set("date_to",i),l=`${Ze}/eod?${u.toString()}`;try{f=await fetch(l)}catch(t){return Xe(`Network error: ${(s=t).message}`),{error:{code:"network_error",message:s.message}}}try{return null!=(a=await f.json()).error?{error:a.error}:{data:a.data,pagination:a.pagination}}catch(t){return Xe(`Parse error: ${(s=t).message}`),{error:{code:"parse_error",message:s.message}}}},tn=function(t,e){var n,r,i,o,a,s;if(Xe(`normalizeEodResponse: ${t.length} records`),0===t.length)return null;for(n=[],i=1,o=0,a=t.length;o<a;o++)r=(s=t[o]).date.substring(0,10),n.push({date:r,high:s.high*i,low:s.low*i,close:s.close*i}),i*=s.split_factor;return{meta:{startDate:n[0].date,endDate:n[n.length-1].date,interval:"1d"},data:n.map(function(t){return[t.high,t.low,t.close]}),_dates:n.map(function(t){return t.date})}},Ye=function(t){var e,n,r,i,o,a,s,u,f,l,c,d,h;if(Xe("gapFillDataSet"),null==t||0===t.data.length)return t;for(({meta:d,data:r,_dates:e}=t),o={},s=u=0,h=e.length;0<=h?u<h:u>h;s=0<=h?++u:--u)o[e[s]]=r[s];for(n=sn(d.startDate,d.endDate),a=[],l=r[0][2],f=0,c=n.length;f<c;f++)null!=o[i=n[f]]?(a.push(o[i]),l=o[i][2]):a.push([l,l,l]);return{meta:d,data:a}},Qe=function(t){var e,n;return e=["function_access_restricted","https_access_restricted","usage_limit_reached"],n=t.code,un.call(e,n)>=0},nn=function(t){return new Promise(function(e){return setTimeout(e,t)})};var hn=function(){Xe("executeSpecialMission"),Xe("sepcialMission ended... bye!")};const gn=require("path");var yn=t.n(gn);const pn=require("fs");var vn,mn,wn,bn,Sn,On,An=t.n(pn);wn=An().promises,mn=null;var En,$n,xn,Nn,Cn,kn,Tn,jn,zn,In,Dn,Jn,_n,Rn,Bn,Pn=function(t){var e;null==t&&(t="./state"),e=yn().isAbsolute(t)?t:yn().resolve(process.cwd(),t),mn=e,An().existsSync(mn)||An().mkdirSync(mn)};Sn=function(t){var e;return e=t+".json",yn().resolve(mn,e)},bn=function(t){return t+".backup"},vn=function(t){var e,n;e=bn(t);try{An().copyFileSync(t,e)}catch(e){throw n="Error: backing up state failed!\n",n+="file: "+t+"\n",n+="reason: "+e.message,new Error(n)}},On=function(t){var e,n,r,i;i=Sn(t),e=bn(i);try{return n=An().readFileSync(e,"utf-8"),r=JSON.parse(n),wn.writeFile(i,n),{contentObj:r,contentJson:n}}catch(t){return{contentObj:r=null,contentJson:n=null}}},({log:Dn,olog:Rn}=w("statecachemodule")),jn={},_n={},$n=null,Nn=null,Tn={},xn=0,Jn=64,kn=null,En=class{constructor(t){this.id=t,this.nextEntry=null,this.previousEntry=$n,null==Nn&&(Nn=this),null!=$n&&($n.nextEntry=this),$n=this,Tn[this.id]=this,++xn>Jn&&Cn()}touch(){null!=this.nextEntry&&(null!=this.previousEntry?(this.nextEntry.previousEntry=this.previousEntry,this.previousEntry.nextEntry=this.nextEntry):(Nn=this.nextEntry,this.nextEntry.previousEntry=null),this.nextEntry=null,this.previousEntry=$n,null!=$n&&($n.nextEntry=this),$n=this)}remove(){return null!=this.nextEntry&&null!=this.previousEntry&&(this.nextEntry.previousEntry=this.previousEntry,this.previousEntry.nextEntry=this.nextEntry),null==this.nextEntry&&null==this.previousEntry&&($n=null,Nn=null),null!=this.nextEntry&&null==this.previousEntry&&(this.nextEntry.previousEntry=null,Nn=this.nextEntry),null==this.nextEntry&&null!=this.previousEntry&&(this.previousEntry.nextEntry=null,$n=this.previousEntry),Bn(this.id)}toString(){var t;return t=this.id+"\n",null!=this.nextEntry?t+="  next: "+this.nextEntry.id+"\n":t+="  next: null\n",null!=this.previousEntry?t+="  previous: "+this.previousEntry.id+"\n":t+="  previous: null\n",t}},zn=function(t){var e,n;new En(t),({contentObj:n,contentJson:e}=function(t){var e,n;n=Sn(t);try{return e=An().readFileSync(n,"utf-8"),{contentObj:JSON.parse(e),contentJson:e}}catch(e){return On(t)}}(t)),null!=n?(jn[t]=e,_n[t]=n):In(t)},In=function(t){null==kn||null==kn[t]?(jn[t]="{}",_n[t]={}):(jn[t]=JSON.stringify(kn[t]),_n[t]=JSON.parse(jn[t]))},Bn=function(t){delete _n[t],delete jn[t],delete Tn[t],xn--},Cn=function(){var t;null!=(t=Nn)&&(null!=(Nn=t.nextEntry)&&(Nn.previousEntry=null),Bn(t.id))};var qn,Mn,Hn=async function(t,e){var n;null!=Tn[t]?Tn[t].touch():new En(t),e&&(_n[t]=e),(n=JSON.stringify(_n[t]))!==jn[t]&&(jn[t]=n,await function(t,e){var n;n=Sn(t),An().writeFileSync(n,e),vn(n)}(t,n))},Ln=function(t){return null==_n[t]?zn(t):Tn[t].touch(),_n[t]},Un=async function(t){var e;null!=(e=Tn[t])&&(e.remove(),await async function(t){var e,n,r,i;i=Sn(t),e=bn(i),n=wn.unlink(i),r=wn.unlink(e);try{await Promise.all([n,r])}catch(t){return}}(t))};({log:qn,olog:Mn}=w("storagemodule"));var Fn,Vn,Gn=function(t){var e;qn("initialize"),(e=t.persistentStateOptions)?(kn=e.defaultState,null!=e.maxCacheSize&&(Jn=e.maxCacheSize),Pn(e.basePath)):Pn()};({log:Fn,olog:Vn}=w("symbolsmodule"));var Zn,Wn,Kn,Yn,Qn,Xn,tr,er,nr,rr,ir,or,ar,sr,ur=function(){Fn("initialize")};({log:rr,olog:ir}=w("datamodule")),sr=function(t){return`did:${t.replace(".","-")}`},Kn=5;var fr=function(t){rr("initialize"),null!=t.freshnessThreshold&&(Kn=t.freshnessThreshold)},lr=async function(){var t,e,n;rr("executeSpecialMission"),n=performance.now(),e=await cr("AAPL"),rr(`full data retrieval took ${performance.now()-n}ms`),t=e.data.length,ir(e.meta),rr(t),ir(e.data[0]),ir(e.data[t-1])},cr=async function(t,e){var n;return rr(`getData ${t}, yearsBack: ${e}`),n=tr(t)?Yn(t):er(t)?Qn(t):await Xn(t),ar(n,e)};ar=function(t,e){var n,r,i;return null==e||null==(null!=t?t.data:void 0)?t:(r=new Date,(n=new Date(Date.UTC(r.getUTCFullYear()-e,r.getUTCMonth(),r.getUTCDate())))<=new Date(t.meta.startDate+"T00:00:00Z")||(i=an(t.meta.startDate,n.toISOString().slice(0,10)))<=0?t:{meta:{startDate:n.toISOString().slice(0,10),endDate:t.meta.endDate,interval:t.meta.interval,historyComplete:!1},data:t.data.slice(i)})},tr=function(t){return rr("isCommodityName"),!1},er=function(t){return rr("isForexPair"),!1},Xn=async function(t){var e,n,r,i;return rr(`getStockData ${t}`),n=sr(t),null==(e=Ln(n)).data?(null!=(e=await ln(t))&&Hn(n,e),e):(e.meta.historyComplete||null!=(i=await cn(t,e.meta.startDate))&&(e=or(i,e),Hn(n,e)),nr(e)||null!=(r=await dn(t,e.meta.endDate))&&(e=Zn(e,r),Hn(n,e)),e)},nr=function(t){var e,n,r;return null!=(null!=t&&null!=(r=t.meta)?r.endDate:void 0)&&(e=new Date(t.meta.endDate+"T00:00:00Z"),n=new Date,Math.floor((n-e)/864e5)<=Kn)},or=function(t,e){var n,r,i,o;return r=[],n=rn(t.meta.endDate),(i=an(n,e.meta.startDate))>0&&(rr(`WARNING: gap detected between ${t.meta.endDate} and ${e.meta.startDate}`),o=t.data[t.data.length-1][2],r=Wn(i,o)),i<0&&(rr("WARNING: gap was negative! This should NEVER happen!"),t.data=t.data.slice(0,i)),{meta:{startDate:t.meta.startDate,endDate:e.meta.endDate,interval:e.meta.interval,historyComplete:t.meta.historyComplete},data:[...t.data,...r,...e.data]}},Zn=function(t,e){var n,r,i,o;return r=[],n=rn(t.meta.endDate),(i=an(n,e.meta.startDate))>0&&(rr(`WARNING: gap detected between ${t.meta.endDate} and ${e.meta.startDate}`),o=t.data[t.data.length-1][2],r=Wn(i,o)),i<0&&(rr("WARNING: gap was negative! This should NEVER happen!"),e.data=e.data.slice(Math.abs(i))),{meta:{startDate:t.meta.startDate,endDate:e.meta.endDate,interval:t.meta.interval,historyComplete:t.meta.historyComplete},data:[...t.data,...r,...e.data]}},Wn=function(t,e){return Array(t).fill([e,e,e])},Yn=function(t){var e;return rr("getCommodityData"),e=sr(t),Ln(e)},Qn=function(t){return rr("getForexPairData"),sr(t),{}},function(t){var e;for(e in t)t[e]&&(h[e]=!0)}({datamodule:!0,marketstackmodule:!0,scimodule:!0,startupmodule:!0});const dr=require("node:http");var hr,gr,yr,pr,vr,mr,wr,br,Sr,Or,Ar,Er,$r,xr,Nr,Cr,kr,Tr,jr,zr,Ir,Dr,Jr,_r,Rr,Br,Pr,qr,Mr,Hr=t.n(dr);require("node:crypto"),({log:Er,olog:xr}=w("scicoremodule")),br=0,Ar="",Pr=null,Br=Object.create(null),Rr=Object.create(null),mr=null,Mr=function(){var t;null!=Pr&&(t=function(){console.log("Gracefully Terminated. Bye!"),process.exit(0)},setTimeout(function(){console.log("Something is taking too long. It is getting killed now ;-) Bye!"),process.exit(0)},2e3),Pr.close(t))},qr=function(t){var e,n,r;if(n=parseInt(process.env.LISTEN_FDS),r=parseInt(process.env.LISTEN_PID),process.pid===r&&n>0)return Sr(t.backlog);if("true"===process.env.SOCKETMODE)throw new Error("No Socket for SOCKETMODE!");if((e=parseInt(process.env.PORT))>0&&(t.listenOn=e),"systemd"===t.listenOn)throw new Error("option systemd failed: no Socket!");return Nr(t)},Sr=function(t){var e,n,r;return Er("handleSocketActivation"),e=null,r=new Promise(function(t){return e=t}),Ar="SystemD FD 3",n={fd:3},Pr=Pr.listen(n,t,e),r},Nr=function(t){var e,n,r;return e=null,n=new Promise(function(t){return e=t}),r={backlog:t.backlog},"string"==typeof t.listenOn?(r.path=t.listenOn,Ar=`unix: ${r.path}`):(r.port=t.listenOn,Ar=`tcp: ${r.port}`),Pr=Pr.listen(r,e),n},vr=function(t,e){console.warn("Attempt to upgrade!"),e.end("HTTP/1.1 403 Forbidden\r\n\r\n")},gr=function(t,e){console.warn(t.message),"ECONNRESET"!==t.code&&e.writable&&e.end("HTTP/1.1 400 Bad Request\r\n\r\n")},$r=function(t,e){var n,r,i,o,a,s,u,f,l,c,d,h,g;return Er("mainRequestHandler_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-\n"),Er(`req.url: ${t.url}`),Er(`req.method: ${t.method}`),Er(`req.headers[Content-Type]: ${t.headers["content-type"]}`),Er(`req.headers[Content-Length]: ${t.headers["content-length"]}`),Er(`req.headers[Transfer-Encoding]: ${t.headers["transfer-encoding"]}`),xr(t.headers),e.on("error",function(t){return console.error(t.message)}),t.on("error",function(t){return console.error(t.message)}),"GET"!==t.method&&"POST"!==t.method?zr(e):(g=t.url,h=t.method[0],null==(c=Rr[`${h}${g}`])?jr(e):(i=c.bodySizeLimit||br,o=parseInt(t.headers["content-length"])||0,a=t.headers["content-type"],xr({cLength:o,cType:a,isJson:d="application/json"===a,hasBody:l=o>0}),d&&!l||l&&0===i?kr(e):(s={meta:wr(t),bodyString:"",bodyObj:void 0,auth:void 0,args:void 0},Object.freeze(s.meta),l?o>i?Ir(e):(n=[],r=0,u=function(a){return Er("dataRead"),(r+=a.length)>i||r>o?(xr({bodyLength:r,bodySizeLimit:i,cLength:o}),Ir(e),t.destroy()):n.push(a)},t.on("data",u),f=function(){if(Er("dataStreamEnd"),r!==o)return xr({bodyLength:r,cLength:o}),Ir(e),t.destroy();if(s.bodyString=Buffer.concat(n,r).toString("utf8"),d)try{s.bodyObj=JSON.parse(s.bodyString)}catch(t){return kr(e)}Cr(t,e,c,s)},void t.on("end",f)):d?kr(e):Cr(t,e,c,s))))},wr=function(t){var e,n;return n=Object.create(null),"string"==typeof(e=t.headers["x-forwarded-for"])&&e.length>6?n.ip=e.split(",")[0]:n.ip=t.socket.remoteAddress,n.host=t.headers.host,n.userAgent=t.headers["user-agent"],n},Cr=async function(t,e,n,r){var i,o;Er("processRequest"),void 0===r.bodyObj?(r.auth=r.bodyString,r.args=r.bodyString):null===r.bodyObj?(r.auth=null,r.args=null):(o=r.bodyObj.auth,i=r.bodyObj.args,void 0===o&&void 0===i?(r.auth=r.bodyObj,r.args=r.bodyObj):(r.auth=o,r.args=i));try{await n.handler(t,e,r)}catch(t){Dr(e,t)}},pr=function(t){var e,n,r,i,o;if(Er("compileRoutes"),null==t||"object"!=typeof t)return[];r=Object.keys(t),o=[];try{for(e=0,i=r.length;e<i;e++)n=r[e],o.push(...yr(n,t[n]))}catch(t){throw new Error("Error on Compiling Routes: "+t.message)}return o},yr=function(t,e){var n,r,i,o,a,s,u,f,l,c,d;if(Er(`compile ${t}`),xr(e),"/"===t[0]&&(t=t.slice(1)),o=e.func,i=e.conf,"function"!=typeof o)throw new Error(`No func for '${t}'!`);if("object"!=typeof i||null==i)throw new Error(`No conf for '${t}'!`);return f=`P/${t}`,a=null,null==i.authOption&&null==i.argsSchema&&(null==i.bodySizeLimit&&(i.bodySizeLimit=0),t.length>3&&0===t.indexOf("get")&&(a="G/",a+=t.slice(3,4).toLowerCase(),a+=t.slice(4))),n=null!=i.authOption?"1":"0",r=null!=i.argsSchema?"1":"0",c=null!=i.resultSchema?"1":"0",l=null!=i.responseAuth?"1":"0",null===mr&&(r="0",c="0"),Er("handlerType: "+(s=`${n}${r}${c}${l}`)),u=Or[s](t,o,i),xr({postRoute:f,getRoute:a}),d={handler:u,bodySizeLimit:i.bodySizeLimit},Object.freeze(d),null!=a?[[a,d],[f,d]]:[[f,d]]},kr=function(t){t.statusCode=400,t.setHeader("Content-Type","text/plain"),t.end('400 "Request Malformed!"\n'),null!=arguments[1]&&console.error(arguments[1])},Tr=function(t){t.statusCode=401,t.setHeader("Content-Type","text/plain"),t.end('401 "Not Authorized!"\n'),null!=arguments[1]&&console.error(arguments[1])},jr=function(t){t.statusCode=404,t.setHeader("Content-Type","text/plain"),t.end('404 "No Endpoint here!"\n'),null!=arguments[1]&&console.error(arguments[1])},zr=function(t){t.statusCode=405,t.setHeader("Content-Type","text/plain"),t.end('405 "No Endpoint here!"\n'),null!=arguments[1]&&console.error(arguments[1])},Ir=function(t){t.statusCode=413,t.setHeader("Content-Type","text/plain"),t.end('413 "Payload too large!"\n'),null!=arguments[1]&&console.error(arguments[1])},Dr=function(t){t.statusCode=500,t.setHeader("Content-Type","text/plain"),t.end('500 "Execution Error!"\n'),null!=arguments[1]&&console.error(arguments[1])},Jr=function(t,e){t.statusCode=422,t.setHeader("Content-Type","text/plain"),t.end(`422 ${e}\n`),null!=arguments[1]&&console.error(e)},_r=function(t,e){t.setHeader("Content-Type","application/json"),"string"==typeof e&&e.length>0?(t.statusCode=200,t.end(e)):(t.statusCode=204,t.end())},Or=Object.create(null),hr=function(t){if("object"!=typeof t||null==t.error)return"No Error Object!"},Or["0000"]=function(t,e,n){return async function(n,r,i){var o,a;return""!==i.bodyString||""!==i.auth||""!==i.args||void 0!==i.bodyObj?kr(r,`Invalid Context for handler 0000 @${t}!`):(Object.freeze(i),(a=await e(void 0,i))?"string"==typeof a&&a.length>0?(o=JSON.stringify(a),Jr(r,o)):Array.isArray(a)&&1===a.length&&"string"==typeof a[0]&&a[0].length>0?(o=JSON.stringify(a[0]),Jr(r,o)):hr(a)?Dr(r,"Invalid result!"):(o='{"error":'+JSON.stringify(a.error)+"}",Jr(r,o)):_r(r,""))}},Or[1e3]=function(t,e,n){var r,i;if("function"!=typeof(r=n.authOption))throw new Error(`authOption not a function @${t}!`);return i=async function(t,n,i){var o,a,s;return(o=await r(t,i))?Tr(n,`Authentication fail! (${o})`):(Object.freeze(i.auth),i.args=void 0,Object.freeze(i),(s=await e(void 0,i))?"string"==typeof s&&s.length>0?(a=JSON.stringify(s),Jr(n,a)):Array.isArray(s)&&1===s.length&&"string"==typeof s[0]&&s[0].length>0?(a=JSON.stringify(s[0]),Jr(n,a)):(o=hr(s))?Dr(n,"Invalid result!"):(a='{"error":'+JSON.stringify(s.error)+"}",Jr(n,a)):_r(n,""))},i},Or["0100"]=function(t,e,n){var r,i;if("function"!=typeof(i=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);return r=async function(t,n,r){var o,a,s;return(o=i(r.args))?kr(n,`Validation fail! (${o})`):(Object.freeze(r),(s=await e(r.args,r))?"string"==typeof s&&s.length>0?(a=JSON.stringify(s),Jr(n,a)):Array.isArray(s)&&1===s.length&&"string"==typeof s[0]&&s[0].length>0?(a=JSON.stringify(s[0]),Jr(n,a)):(o=hr(s))?Dr(n,"Invalid result!"):(a='{"error":'+JSON.stringify(s.error)+"}",Jr(n,a)):_r(n,""))},r},Or[1100]=function(t,e,n){var r,i,o;if("function"!=typeof(r=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(o=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);return i=async function(t,n,i){var a,s,u;return(a=await r(t,i))?Tr(n,`Authentication fail! (${a})`):(Object.freeze(i.auth),(a=o(i.args))?kr(n,`Validation fail! (${a})`):(Object.freeze(i),(u=await e(i.args,i))?"string"==typeof u&&u.length>0?(s=JSON.stringify(u),Jr(n,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s=JSON.stringify(u[0]),Jr(n,s)):(a=hr(u))?Dr(n,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",Jr(n,s)):_r(n,"")))},i},Or["0010"]=function(t,e,n){var r;if("function"!=typeof(r=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);return async function(n,i,o){var a,s;return""!==o.bodyString||""!==o.auth||""!==o.args||void 0!==o.bodyObj?kr(i,`Invalid Context for handler 0010 @${t}!`):(Object.freeze(o),s=await e(void 0,o),r(s)?"string"==typeof s&&s.length>0?(a=JSON.stringify(s),Jr(i,a)):Array.isArray(s)&&1===s.length&&"string"==typeof s[0]&&s[0].length>0?(a=JSON.stringify(s[0]),Jr(i,a)):hr(s)?Dr(i,"Invalid result!"):(a='{"error":'+JSON.stringify(s.error)+"}",Jr(i,a)):_r(i,JSON.stringify(s)))}},Or[1010]=function(t,e,n){var r,i,o;if("function"!=typeof(r=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(o=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);return i=async function(t,n,i){var a,s,u;return(a=await r(t,i))?Tr(n,`Authentication fail! (${a})`):(Object.freeze(i.auth),i.args=void 0,Object.freeze(i),u=await e(void 0,i),(a=o(u))?"string"==typeof u&&u.length>0?(s=JSON.stringify(u),Jr(n,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s=JSON.stringify(u[0]),Jr(n,s)):(a=hr(u))?Dr(n,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",Jr(n,s)):_r(n,JSON.stringify(u)))},i},Or["0110"]=function(t,e,n){var r,i,o;if("function"!=typeof(i=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(o=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);return r=async function(t,n,r){var a,s,u;return(a=i(r.args))?kr(n,`Validation fail! (${a})`):(Object.freeze(r),u=await e(r.args,r),(a=o(u))?"string"==typeof u&&u.length>0?(s=JSON.stringify(u),Jr(n,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s=JSON.stringify(u[0]),Jr(n,s)):(a=hr(u))?Dr(n,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",Jr(n,s)):_r(n,JSON.stringify(u)))},r},Or[1110]=function(t,e,n){var r,i,o,a;if("function"!=typeof(r=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(o=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(a=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);return i=async function(t,n,i){var s,u,f;return(s=await r(t,i))?Tr(n,`Authentication fail! (${s})`):(Object.freeze(i.auth),(s=o(i.args))?kr(n,`Validation fail! (${s})`):(Object.freeze(i),f=await e(i.args,i),(s=a(f))?"string"==typeof f&&f.length>0?(u=JSON.stringify(f),Jr(n,u)):Array.isArray(f)&&1===f.length&&"string"==typeof f[0]&&f[0].length>0?(u=JSON.stringify(f[0]),Jr(n,u)):(s=hr(f))?Dr(n,"Invalid result!"):(u='{"error":'+JSON.stringify(f.error)+"}",Jr(n,u)):_r(n,JSON.stringify(f))))},i},Or["0001"]=function(t,e,n){var r;if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return async function(n,i,o){var a,s,u;return""!==o.bodyString||""!==o.auth||""!==o.args||void 0!==o.bodyObj?kr(i,`Invalid Context for handler 0001 @${t}!`):(Object.freeze(o),(s=await e(void 0,o))?"string"==typeof s&&s.length>0?(a='{"error":'+JSON.stringify(s)+"}",a=await r(a,o),Jr(i,a)):Array.isArray(s)&&1===s.length&&"string"==typeof s[0]&&s[0].length>0?(a='{"error":'+JSON.stringify(s[0])+"}",a=await r(a,o),Jr(i,a)):hr(s)?Dr(i,"Invalid result!"):(a='{"error":'+JSON.stringify(s.error)+"}",a=await r(a,o),Jr(i,a)):(u=await r('{"result":""}',o),_r(i,u)))}},Or[1001]=function(t,e,n){var r,i,o;if("function"!=typeof(i=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return o=async function(t,n,o){var a,s,u,f;return(a=await i(t,o))?Tr(n,`Authentication fail! (${a})`):(Object.freeze(o.auth),o.args=void 0,Object.freeze(o),(u=await e(void 0,o))?"string"==typeof u&&u.length>0?(s='{"error":'+JSON.stringify(u)+"}",s=await r(s,o),Jr(n,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s='{"error":'+JSON.stringify(u[0])+"}",s=await r(s,o),Jr(n,s)):(a=hr(u))?Dr(n,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",s=await r(s,o),Jr(n,s)):(f=await r('{"result":""}',o),_r(n,f)))},o},Or["0101"]=function(t,e,n){var r,i,o;if("function"!=typeof(o=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return i=async function(t,n,i){var a,s,u,f;return(a=o(i.args))?kr(n,`Validation fail! (${a})`):(Object.freeze(i),(u=await e(i.args,i))?"string"==typeof u&&u.length>0?(s='{"error":'+JSON.stringify(u)+"}",s=await r(s,i),Jr(n,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s='{"error":'+JSON.stringify(u[0])+"}",s=await r(s,i),Jr(n,s)):(a=hr(u))?Dr(n,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",s=await r(s,i),Jr(n,s)):(f=await r('{"result":""}',i),_r(n,f)))},i},Or[1101]=function(t,e,n){var r,i,o,a;if("function"!=typeof(i=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(a=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return o=async function(t,n,o){var s,u,f,l;return(s=await i(t,o))?Tr(n,`Authentication fail! (${s})`):(Object.freeze(o.auth),(s=a(o.args))?kr(n,`Validation fail! (${s})`):(Object.freeze(o),(f=await e(o.args,o))?"string"==typeof f&&f.length>0?(u='{"error":'+JSON.stringify(f)+"}",u=await r(u,o),Jr(n,u)):Array.isArray(f)&&1===f.length&&"string"==typeof f[0]&&f[0].length>0?(u='{"error":'+JSON.stringify(f[0])+"}",u=await r(u,o),Jr(n,u)):(s=hr(f))?Dr(n,"Invalid result!"):(u='{"error":'+JSON.stringify(f.error)+"}",u=await r(u,o),Jr(n,u)):(l=await r('{"result":""}',o),_r(n,l))))},o},Or["0011"]=function(t,e,n){var r,i;if("function"!=typeof(i=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return async function(n,o,a){var s,u,f;return""!==a.bodyString||""!==a.auth||""!==a.args||void 0!==a.bodyObj?kr(o,`Invalid Context for handler 0011 @${t}!`):(Object.freeze(a),u=await e(void 0,a),i(u)?"string"==typeof u&&u.length>0?(s='{"error":'+JSON.stringify(u)+"}",s=await r(s,a),Jr(o,s)):Array.isArray(u)&&1===u.length&&"string"==typeof u[0]&&u[0].length>0?(s='{"error":'+JSON.stringify(u[0])+"}",s=await r(s,a),Jr(o,s)):hr(u)?Dr(o,"Invalid result!"):(s='{"error":'+JSON.stringify(u.error)+"}",s=await r(s,a),Jr(o,s)):(f='{"result":'+JSON.stringify(u)+"}",f=await r(f,a),_r(o,f)))}},Or[1011]=function(t,e,n){var r,i,o,a;if("function"!=typeof(i=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(a=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return o=async function(t,n,o){var s,u,f,l;return(s=await i(t,o))?Tr(n,`Authentication fail! (${s})`):(Object.freeze(o.auth),o.args=void 0,Object.freeze(o),f=await e(void 0,o),(s=a(f))?"string"==typeof f&&f.length>0?(u='{"error":'+JSON.stringify(f)+"}",u=await r(u,o),Jr(n,u)):Array.isArray(f)&&1===f.length&&"string"==typeof f[0]&&f[0].length>0?(u='{"error":'+JSON.stringify(f[0])+"}",u=await r(u,o),Jr(n,u)):(s=hr(f))?Dr(n,"Invalid result!"):(u='{"error":'+JSON.stringify(f.error)+"}",u=await r(u,o),Jr(n,u)):(l='{"result":'+JSON.stringify(f)+"}",l=await r(l,o),_r(n,l)))},o},Or["0111"]=function(t,e,n){var r,i,o,a;if("function"!=typeof(o=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(a=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return i=async function(t,n,i){var s,u,f,l;return(s=o(i.args))?kr(n,`Validation fail! (${s})`):(Object.freeze(i),f=await e(i.args,i),(s=a(f))?"string"==typeof f&&f.length>0?(u='{"error":'+JSON.stringify(f)+"}",u=await r(u,i),Jr(n,u)):Array.isArray(f)&&1===f.length&&"string"==typeof f[0]&&f[0].length>0?(u='{"error":'+JSON.stringify(f[0])+"}",u=await r(u,i),Jr(n,u)):(s=hr(f))?Dr(n,"Invalid result!"):(u='{"error":'+JSON.stringify(f.error)+"}",u=await r(u,i),Jr(n,u)):(l='{"result":'+JSON.stringify(f)+"}",l=await r(l,i),_r(n,l)))},i},Or[1111]=function(t,e,n){var r,i,o,a,s;if("function"!=typeof(i=n.authOption))throw new Error(`authOption not a function @${t}!`);if("function"!=typeof(a=mr(n.argsSchema,!0)))throw new Error(`validateArgs is not a function @${t}!`);if("function"!=typeof(s=mr(n.resultSchema,!0)))throw new Error(`validateResult is not a function @${t}!`);if("function"!=typeof(r=n.responseAuth))throw new Error(`addResponseAuth is not a function @${t}!`);return o=async function(t,n,o){var u,f,l,c;return(u=await i(t,o))?Tr(n,`Authentication fail! (${u})`):(Object.freeze(o.auth),(u=a(o.args))?kr(n,`Validation fail! (${u})`):(Object.freeze(o),l=await e(o.args,o),(u=s(l))?"string"==typeof l&&l.length>0?(f='{"error":'+JSON.stringify(l)+"}",f=await r(f,o),Jr(n,f)):Array.isArray(l)&&1===l.length&&"string"==typeof l[0]&&l[0].length>0?(f='{"error":'+JSON.stringify(l[0])+"}",f=await r(f,o),Jr(n,f)):(u=hr(l))?Dr(n,"Invalid result!"):(f='{"error":'+JSON.stringify(l.error)+"}",f=await r(f,o),Jr(n,f)):(c='{"result":'+JSON.stringify(l)+"}",c=await r(c,o),_r(n,c))))},o};var Lr,Ur,Fr,Vr,Gr,Zr,Wr=function(t,e,n){if(null!==Pr)throw new Error("Server already running!");if("string"!=typeof t)throw new Error("Route not a string!");if("function"!=typeof e)throw new Error("Func not a function!");if(null!=Br[t])throw new Error("Cannot add route twice!");if(null==e)throw new Error("function must be defined!");null!=n&&"object"==typeof n||(n=Object.create(null)),Br[t]={func:e,conf:n}},Kr=function(t){if(null!==Pr)throw new Error("Server already running!");if("function"!=typeof t)throw new Error("Func not a function!");mr=t},Yr=async function(t){var e,n,r,i,o,a,s,u,f,l,c;for(Er("sciStartServer"),null!=t&&"object"==typeof t||(t=Object.create(null)),br=t.bodySizeLimit||5e5,l=t.requestTimeout||5e4,n=t.headersTimeout||8e3,o=t.keepAliveTimeout||12e4,t.maxHeadersCount,u=t.maxHeaderSize||2048,i=0,a=(c=pr(Br)).length;i<a;i++)f=c[i],Rr[f[0]]=f[1];Br=null,r={headersTimeout:n,maxHeaderSize:u,requestTimeout:l,keepAliveTimeout:o},(Pr=Hr().createServer(r)).on("request",$r),Pr.on("upgrade",vr),Pr.on("clientError",gr),"number"==typeof t.backlog&&(e=t.backlog),s={backlog:e,listenOn:t.listenOn||3333},await qr(s),xr({listeningMode:Ar}),process.on("SIGTERM",Mr),process.on("SIGINT",Mr)};({log:Lr,olog:Ur}=w("accesssci")),Kr(ee),Wr("grantAccess",S,{bodySizeLimit:1024,authOption:he,argsSchema:{authCode:8,ttlMS:2}}),Wr("revokeAccess",O,{bodySizeLimit:1024,authOption:he,argsSchema:8}),({log:Fr,olog:Vr}=w("datasci")),Kr(ee),Wr("getEODHLCData",async function(t){return await cr(t.dataKey,t.yearsBack)},{bodySizeLimit:1024,authOption:function(t){return null!=t&&A(t.authCode)},argsSchema:{authCode:8,dataKey:14,yearsBack:30},resultSchema:{meta:{startDate:14,endDate:14,interval:"1d",historyComplete:1},data:3}}),({log:Gr,olog:Zr}=w("scimodule"));var Qr,Xr,ti=async function(){Gr("prepareAndExpose"),await Yr(),Gr("Server listening!")};({log:Qr,olog:Xr}=w("startupmodule"));var ei,ni,ri,ii,oi,ai,si,ui,fi,li,ci,di=async function(){Qr("serviceStartup"),await Yr()};({log:ii,olog:oi}=w("tradovatemodule")),ci=null,li=null;var hi=function(t){ii("initialize")};fi=function(t){ii("saveStorage"),t&&(li=t),Hn("datahubState",li)},ri=async function(t,e){var n,r,i,o;ii("getRequest"),r={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}},null!=e&&(r.headers.Authorization=`Bearer ${e}`);try{i=await fetch(t,r)}catch(t){n=t,console.error(n)}try{if(i.ok)return await i.json();console.error("status: "+i.status),o=await i.text(),console.error(o)}catch(t){n=t,console.error(n)}},ai=async function(t,e,n){var r,i,o,a;ii("postRequest"),i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},null!=n&&(i.headers.Authorization=`Bearer ${n}`);try{o=await fetch(t,i)}catch(t){r=t,console.error(r)}try{if(o.ok)return await o.json();console.error("status: "+o.status),a=await o.text(),console.error(a)}catch(t){r=t,console.error(r)}},si=async function(){var t,e;ii("refreshToken"),e=ci+"/auth/renewAccessToken",t=await ri(e,li.accessToken),oi(t),null!=t.accessToken&&(li.accessToken=t.accessToken),null!=t.mdAccessToken&&(li.mdAccessToken=t.mdAccessToken),null!=t.expirationTime&&(li.expirationTime=t.expirationTime),fi()},ui=async function(){var t,e,n;ii("requestAccessToken"),e={name:null,password:null,appId:"sentinel",appVersion:null,cid:null,sec:null},n=ci+"/auth/accesstokenrequest",t=await ai(n,e),oi(t),null!=t&&fi(t)},ni=function(){var t,e,n,r;return ii("ensureFreshToken"),null==(e=li.expirationTime)?ui():(t=new Date(e).getTime(),n=(new Date).getTime(),oi({exp:t,now:n,timeToExpiry:r=t-n}),r<0?ui():r<114e4?si():void 0)},ei=async function(){var t,e;ii("checkSymbols"),ii("using url: "+(e=ci+"/product/list")),t=await ri(e,li.mdAccessToken),oi(t)};var gi=async function(t){ii("startSession"),t&&await ui(),await ni(),setInterval(ni,6e5),await ei(),setInterval(ei,36e5)};const yi={accessmodule:e,authmodule:r,configmodule:i,datamodule:f,dateutilsmodule:o,debugmodule:l,earlyblockermodule:n,marketstackmodule:a,scimodule:c,startupmodule:d,storagemodule:s,symbolsmodule:u,tradovatemodule:y};global.allModules=yi,async function(){var t,e,n;try{return n=function(){var n;for(e in n=[],yi)null!=(t=yi[e]).initialize&&n.push(t.initialize(i));return n}(),await Promise.all(n),await yi.startupmodule.serviceStartup()}catch(t){return ke("@run: "+t.message)}}()})();